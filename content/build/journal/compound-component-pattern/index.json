{"code":"var Component=(()=>{var p=Object.create;var o=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var g=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),k=(a,e)=>{for(var l in e)o(a,l,{get:e[l],enumerable:!0})},c=(a,e,l,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of u(e))!v.call(a,s)&&s!==l&&o(a,s,{get:()=>e[s],enumerable:!(r=m(e,s))||r.enumerable});return a};var f=(a,e,l)=>(l=a!=null?p(y(a)):{},c(e||!a||!a.__esModule?o(l,\"default\",{value:a,enumerable:!0}):l,a)),N=a=>c(o({},\"__esModule\",{value:!0}),a);var i=g((A,t)=>{t.exports=_jsx_runtime});var w={};k(w,{default:()=>b,frontmatter:()=>M});var n=f(i()),M={title:\"The Compound Component pattern\",description:\"Exploring the Compound Component pattern and how it helps us build more flexible components\",tags:[\"React\",\"Composition\",\"Api Design\"],date:\"04/03/2023\",imageSrc:\"./image.jpg\",imageAlt:\"Close-up of a beautiful roman castle with a metallic copper coloured towers rooftops, concrete allure and dark blue interleaved with chatelle tiles.\",imageCredit:\"Leonardo Diffussion: beautiful roman castle of lego bricks, composition, close-up\"};function d(a){let e={a:\"a\",blockquote:\"blockquote\",code:\"code\",em:\"em\",h2:\"h2\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",...a.components},{Details:l,IllustrationTime:r}=e;return l||h(\"Details\",!0),r||h(\"IllustrationTime\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"Striking an acceptable level of composition is a challenging feat, not only does it take a good time to think about the feature you want to build but it also requires you to reason about and predict the use-cases the component will have to meet in the future.\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Fortunately\"}),\" for us, there are multiple patterns in React that we can apply to increase the composability of our components. One that I really appreciate is the \",(0,n.jsx)(e.code,{children:\"Compound Component\"}),\" pattern and its variations.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"compound-component\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#compound-component\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Compound Component\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"As a refresher on the \",(0,n.jsx)(e.code,{children:\"Compound Component\"}),\" pattern, it lets you split out a component into extendable smaller components that you can compose to build interfaces.\"]}),`\n`,(0,n.jsxs)(r,{summary:\"Example of a real problem from Tom \\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB}, a SWE at WideOpenAI\\xAE\",children:[(0,n.jsxs)(e.p,{children:[\"Tom \\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB} is the happy maintainer of the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component:\"]}),(0,n.jsx)(e.pre,{\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsx)(e.code,{children:(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"items\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"menuItems\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),\" />\",`\n`]})})}),(0,n.jsx)(e.p,{children:\"Just a simple component that renders a button to toggle a menu and its items. It's a very common component that you'll find in many UI libraries and you probably have a similar component in your codebase (so do I!).\"}),(0,n.jsx)(e.p,{children:\"But one day Tom's boss \\u{1F935}\\u{1F3FD}\\u200D\\u2640\\uFE0F calls him:\"}),(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"\\u{1F935}\\u{1F3FD}\\u200D\\u2640\\uFE0F Hey, our clients are having trouble checking if they're logged in. Our top bar menu should reflect that.\"}),`\n`]}),(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"\\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB} Sure thing, I'll get right to it!\"}),`\n`]}),(0,n.jsxs)(e.p,{children:[\"Easy peasy! - says Tom \\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB} - I'll start by adding two new props to the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component to highlight the login status:\"]}),(0,n.jsx)(e.pre,{\"data-add\":\"2\",\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",\"data-diff-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",\"data-add\":!0,\"data-diff-line-number\":\"2\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"buttonLabel\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"loggedIn\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"?\"}),\" \",\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"Signed in as Tom - Menu \"}),\"'\",\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\":\"}),\" \",\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"Unlogged - Menu\"}),\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",\"data-diff-line-number\":\"3\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"items\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"menuItems\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",\"data-diff-line-number\":\"4\",children:[\"/>\",`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"And it all \",(0,n.jsx)(e.em,{children:\"just\"}),\" works, he has a happy day and goes home.\"]}),(0,n.jsx)(e.p,{children:\"But then you he gets another call from his boss:\"}),(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"\\u{1F935}\\u{1F3FD}\\u200D\\u2640\\uFE0F Hey, our users are having trouble finding the admin panel. I need you to highlight the admin option in the top bar menu.\"}),`\n`]}),(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"\\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB} Alright!\"}),`\n`]}),(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"\\u{1F935}\\u{1F3FD}\\u200D\\u2640\\uFE0F But it should only be highlighted when the user is an admin!\"}),`\n`]}),(0,n.jsx)(e.p,{children:\"Let's just add another prop! \\u2014 Tom \\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB}.\"}),(0,n.jsx)(e.pre,{\"data-add\":\"3\",\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",\"data-diff-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",\"data-diff-line-number\":\"2\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"buttonLabel\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"loggedIn\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"?\"}),\" \",\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"Signed in as Tom - Menu \"}),\"'\",\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\":\"}),\" \",\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"Unlogged - Menu\"}),\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",\"data-add\":!0,\"data-diff-line-number\":\"3\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"isAdmin\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isAdmin\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",\"data-diff-line-number\":\"4\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"items\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"menuItems\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"5\",\"data-diff-line-number\":\"5\",children:[\"/>\",`\n`]})]})}),(0,n.jsx)(e.p,{children:\"And it works again! Tom \\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB} is happy and his changes are deployed to the website. But then he gets another call:\"}),(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"\\u{1F935}\\u{1F3FD}\\u200D\\u2640\\uFE0F Hey, the website is not working! The menu is not opening anymore!\"}),`\n`]}),(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"\\u{1F646}\\u{1F3FB}\\u200D\\u2642\\uFE0F What!? I didn't change anything!\"}),`\n`]}),(0,n.jsxs)(e.p,{children:[\"So he sets to debug the issue and finds out that while he was adding the new button he introduced a regression that broke the menu in a page that he didn't even know existed and that it was using the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component.\"]}),(0,n.jsx)(e.p,{children:\"He fixes it and his boss \\u{1F935}\\u{1F3FD}\\u200D\\u2640\\uFE0F thanks him for his hard work.\"}),(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"\\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB} Wait! What if my boss calls me up again to change the Menu component? There has has to be a better way of extending the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component without introducing regressions.\"]}),`\n`]}),(0,n.jsxs)(e.p,{children:[\"Does this story feel familiar to you? If so, you're not alone. I've been there too! Let's see how we can improve the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component to make it more flexible and avoid introducing regressions applying \",(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Separation_of_concerns\",children:\"separation of concerns\"}),\" with the Compound Componet pattern.\"]})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Let's take a look at the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component that Tom \\u{1F9D1}\\u{1F3FB}\\u200D\\u{1F4BB} built:\"]}),`\n`,(0,n.jsx)(e.pre,{\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"buttonLabel\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"loggedIn\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"?\"}),\" \",\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"Signed in as Tom - Menu\"}),\"'\",\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\":\"}),\" \",\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"Unlogged - Menu\"}),\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"isAdmin\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isAdmin\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"items\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"menuItems\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"5\",children:[\"/>\",`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"It has a few problems:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"It also doesn't allow you to customize the menu items rendering logic.\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"It's now linked to implementation details. We want the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component to be \",(0,n.jsx)(e.strong,{children:\"generic\"}),\", we want to use it for other purposes as well. So when extending it for a new use-case we have to make sure that we don't break the existing ones.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"This is the golden example of how you'd go about using the above component if it were using the \",(0,n.jsx)(e.code,{children:\"Compound Component\"}),\" pattern:\"]}),`\n`,(0,n.jsx)(e.pre,{\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuButton\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",children:[\"    \",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"loggedIn\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"?\"}),\" \",\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"Signed in as Tom - Menu\"}),\"'\",\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\":\"}),\" \",\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"Unlogged - Menu\"}),\"'\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",children:[\"  </\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuButton\"}),\">\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"5\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"6\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuList\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"7\",children:[\"    <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Item 1</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"8\",children:[\"    <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Item 2</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"9\",children:[\"    \",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isAdmin\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"&&\"}),\" <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Admin</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"10\",children:[\"  </\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuList\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"11\",children:[\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\">\",`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"The \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component is the parent component that holds the state of the menu and passes it down to its children. The \",(0,n.jsx)(e.code,{children:\"MenuButton\"}),\" and \",(0,n.jsx)(e.code,{children:\"MenuItem\"}),\" consume the state and render accordingly. One obvious benefit of this is that it gives you \",(0,n.jsx)(e.strong,{children:\"control\"}),\" on \",(0,n.jsx)(e.em,{children:\"what\"}),\" pieces of the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" to render and \",(0,n.jsx)(e.em,{children:\"where\"}),\" to render them.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"You could, for example, skip the button alltogether and make it so firing an action toggles on the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{\"data-add\":\"2\",\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",\"data-diff-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",\"data-add\":!0,\"data-diff-line-number\":\"2\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"LoginDialogWithMenuToggle\"}),\" />\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",\"data-diff-line-number\":\"3\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",\"data-diff-line-number\":\"4\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuList\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"5\",\"data-diff-line-number\":\"5\",children:[\"    <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Protected action 1</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"6\",\"data-diff-line-number\":\"6\",children:[\"    <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Protected action 2</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"7\",\"data-diff-line-number\":\"7\",children:[\"    <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Protected action 3</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"8\",\"data-diff-line-number\":\"8\",children:[\"  </\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuList\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"9\",\"data-diff-line-number\":\"9\",children:[\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\">\",`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"It was as simple as changing that single line of code and we were able to extend the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component to support a new use-case.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"But what is going on under the hood? How does the \",(0,n.jsx)(e.code,{children:\"LoginDialogWithMenuToggle\"}),\" component know how to trigger the state?\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The answer is the React.Children API and the \",(0,n.jsx)(e.code,{children:\"cloneElement\"}),\" method. Here's how it might work (don't give the code too much thought):\"]}),`\n`,(0,n.jsx)(e.pre,{\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",children:[(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"function\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"Menu\"}),\"({ \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),\" }) {\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"const\"}),\" [\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\", \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"setIsOpen\"}),\"] \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"React\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"useState\"}),\"(\",(0,n.jsx)(e.span,{style:{color:\"var(--base09)\"},children:\"false\"}),\")\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"const\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"toggleMenu\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),\" () \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"=>\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"setIsOpen\"}),\"(\",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"!\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\")\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"5\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"6\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"const\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"childrenWithProps\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"React\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"Children\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"map\"}),\"(\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),\", (\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"child\"}),\") \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"=>\"}),\" {\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"7\",children:[\"    \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"if\"}),\" (\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"React\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"isValidElement\"}),\"(\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"child\"}),\")) {\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-highlight\":\"true\",\"data-line-number\":\"8\",children:[\"      \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"return\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"React\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"cloneElement\"}),\"(\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"child\"}),\", { \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\", \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"toggleMenu\"}),\" })\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"9\",children:[\"    }\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"10\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"11\",children:[\"    \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"return\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"child\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"12\",children:[\"  })\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"13\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"14\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"return\"}),\" <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"childrenWithProps\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"15\",children:[\"}\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"16\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"17\",children:[(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"function\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"MenuList\"}),\"({ \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),\", \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\" }) {\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-highlight\":\"true\",\"data-line-number\":\"18\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"return\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"?\"}),\" <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\"> \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\":\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base09)\"},children:\"null\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"19\",children:[\"}\",`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"In this case, \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" is going through all of its \",(0,n.jsx)(e.strong,{children:\"direct\"}),\" children and cloning them to pass them down the \",(0,n.jsx)(e.code,{children:\"isOpen\"}),\" and \",(0,n.jsx)(e.code,{children:\"toggleMenu\"}),\" props.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"This sounds great \",(0,n.jsx)(e.em,{children:\"initially\"}),\" but it leads you to write fragile code. To illustrate that, imagine you had to put a wrapper between \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" and \",(0,n.jsx)(e.code,{children:\"MenuList\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{\"data-add\":\"4,10\",\"data-filename\":\"broken-component.jsx\",\"data-broken\":\"true\",\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",\"data-diff-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",\"data-diff-line-number\":\"2\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuButton\"}),\">Where is my list? :( </\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuButton\"}),\">\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",\"data-diff-line-number\":\"3\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",\"data-add\":!0,\"data-diff-line-number\":\"4\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"5\",\"data-diff-line-number\":\"5\",children:[\"    <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuList\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"6\",\"data-diff-line-number\":\"6\",children:[\"      <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Item 1</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"7\",\"data-diff-line-number\":\"7\",children:[\"      <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Item 2</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"8\",\"data-diff-line-number\":\"8\",children:[\"      <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Item 3</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"9\",\"data-diff-line-number\":\"9\",children:[\"    </\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuList\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"10\",\"data-add\":!0,\"data-diff-line-number\":\"10\",children:[\"  </\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"11\",\"data-diff-line-number\":\"11\",children:[\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\">\",`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Now the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component won't be able to pass down the props to the \",(0,n.jsx)(e.code,{children:\"MenuList\"}),\" because it's not a \",(0,n.jsx)(e.strong,{children:\"direct\"}),\" child anymore. We have the entire functionality of \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" broken because it is tight to an implementation detail that it can't enforce.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"To fix this, we need to be \",(0,n.jsx)(e.em,{children:\"flexible\"}),\" about \",(0,n.jsx)(e.em,{children:\"where\"}),\" we put the elements in the tree!\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Note: The \",(0,n.jsx)(e.code,{children:\"Compound Component\"}),\" pattern as described here is not encouraged anymore \",(0,n.jsx)(e.a,{href:\"https://beta.reactjs.org/reference/react/Children\",children:\"due to the API it uses are fragile\"}),\" as shown above. Going forward you should only be using the \",(0,n.jsx)(e.code,{children:\"Flexible Compound Component\"}),\" pattern we'll see now.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"flexible-compound-component\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#flexible-compound-component\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Flexible Compound Component\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"This pattern works by enhancing the \",(0,n.jsx)(e.code,{children:\"Compound Component\"}),\" pattern by using the React Context API to pass down the state to its children \",(0,n.jsx)(e.em,{children:\"anywhere in the tree\"}),\". To the developer implementing a Flexible Compound Component, it's \",(0,n.jsx)(\"s\",{children:\"exactly like\"}),\" very similar to the component we've seen so far:\"]}),`\n`,(0,n.jsx)(e.pre,{\"data-filename\":\"functional-component.jsx\",\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuButton\"}),\">I toggle the collapsable menu! :)</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuButton\"}),\">\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"5\",children:[\"    <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuList\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"6\",children:[\"      <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Item 1</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"7\",children:[\"      <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Item 2</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"8\",children:[\"      <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">Item 3</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuItem\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"9\",children:[\"    </\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuList\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"10\",children:[\"  </\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"11\",children:[\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"Menu\"}),\">\",`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"But internally the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" component is now exposing its state via React Context:\"]}),`\n`,(0,n.jsx)(e.pre,{\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-highlight\":\"true\",\"data-line-number\":\"1\",children:[(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"const\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"MenuContext\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"React\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"createContext\"}),\"()\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",children:[(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"function\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"Menu\"}),\"({ \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),\" }) {\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"const\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"state\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"React\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"useState\"}),\"(\",(0,n.jsx)(e.span,{style:{color:\"var(--base09)\"},children:\"false\"}),\")\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"5\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"6\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"return\"}),\" (\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-highlight\":\"true\",\"data-line-number\":\"7\",children:[\"    <\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuContext.Provider\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"value\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"state\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"8\",children:[\"      <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"9\",children:[\"    </\",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"MenuContext.Provider\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"10\",children:[\"  )\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"11\",children:[\"}\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"12\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"13\",children:[(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"function\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"MenuButton\"}),\"({ \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),\" }) {\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-highlight\":\"true\",\"data-line-number\":\"14\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"const\"}),\" [, \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"setIsOpen\"}),\"] \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"React\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"useContext\"}),\"(\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"MenuContext\"}),\")\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"15\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"16\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"const\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"toggle\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),\" () \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"=>\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"setIsOpen\"}),\"((\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\") \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"=>\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"!\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\")\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"17\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"18\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"return\"}),\" <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"button\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"onClick\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"toggle\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),\">\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"button\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"19\",children:[\"}\",`\n`]}),(0,n.jsx)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"20\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"21\",children:[(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"function\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"MenuList\"}),\"({ \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),\" }) {\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-highlight\":\"true\",\"data-line-number\":\"22\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0A)\"},children:\"const\"}),\" [\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\"] \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"React\"}),\".\",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"useContext\"}),\"(\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"MenuContext\"}),\")\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"23\",children:[\"  \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"return\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"isOpen\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"?\"}),\" <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\">\",(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"children\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0F)\"},children:\"}\"}),\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"div\"}),\"> \",(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\":\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base09)\"},children:\"null\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"24\",children:[\"}\",`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"We can see that now, we're not limited to the direct children of \",(0,n.jsx)(e.code,{children:\"Menu\"}),\" to consume the state. We can put the \",(0,n.jsx)(e.code,{children:\"MenuButton\"}),\" anywhere in the tree and it will still be able to toggle the \",(0,n.jsx)(e.code,{children:\"Menu\"}),\".\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsxs)(l,{summary:\"Did you have a d\\xE9ja v\\xFA with this pattern?\",children:[(0,n.jsxs)(e.p,{children:[\"This pattern is not only a React thing. Behold the \",(0,n.jsxs)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select\",children:[(0,n.jsx)(e.code,{children:\"option\"}),\"/\",(0,n.jsx)(e.code,{children:\"select\"})]}),\" DOM elemets:\"]}),(0,n.jsx)(e.pre,{\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"select\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"className\"}),(0,n.jsx)(e.span,{style:{color:\"var(--base0E)\"},children:\"=\"}),'\"',(0,n.jsx)(e.span,{style:{color:\"var(--base0B)\"},children:\"...\"}),'\"',\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"option\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"disabled\"}),\">Option 1</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"option\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"option\"}),\" \",(0,n.jsx)(e.span,{style:{color:\"var(--base0D)\"},children:\"selected\"}),\">Option 2</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"option\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",children:[\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"select\"}),\">\",`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"Or the magnificient \",(0,n.jsxs)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/details\",children:[(0,n.jsx)(e.code,{children:\"details\"}),\"/\",(0,n.jsx)(e.code,{children:\"summary\"})]}),\" elements that are used to create collapsables (this very collapsable is using those elements \\u{1F92B}):\"]}),(0,n.jsx)(e.pre,{\"data-line-numbers\":\"true\",tabIndex:\"0\",\"data-lang\":\"javascript\",style:{color:\"var(--base05)\",backgroundColor:\"var(--base00)\"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"1\",children:[\"<\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"details\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"2\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"summary\"}),\">Click me!</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"summary\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"3\",children:[\"  <\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"p\"}),\">Some hidden content</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"p\"}),\">\",`\n`]}),(0,n.jsxs)(e.span,{className:\"codeblock-line\",\"data-line-number\":\"4\",children:[\"</\",(0,n.jsx)(e.span,{style:{color:\"var(--base08)\"},children:\"details\"}),\">\",`\n`]})]})}),(0,n.jsx)(e.p,{children:\"Its amazing that we're able to apply this pattern in React and make it even more flexible with shared state.\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Overall this API is way more flexible \\u{1F4AA}. The \",(0,n.jsx)(e.code,{children:\"Compound Component\"}),\" pattern allowed us to compose our Menu component to fit our needs. We can also extend our Menu family of components in a variety of different ways. Got a new use-case? Just add a new component to the family and you're good to go!\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"We've just covered how the \",(0,n.jsx)(e.code,{children:\"Compound Component\"}),\" pattern gives us the ability to extract and the \",(0,n.jsx)(e.code,{children:\"Flexible Compound Component\"}),\" pattern gives us . But there's still plenty of room for improvement. Let's see how we can scale-up this API and optimize it for performance in the next article.\"]})]})}function b(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(d,{...a})}):d(a)}function h(a,e){throw new Error(\"Expected \"+(e?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return N(w);})();\n;return Component;","frontmatter":{"title":"The Compound Component pattern","description":"Exploring the Compound Component pattern and how it helps us build more flexible components","tags":["React","Composition","Api Design"],"date":"04/03/2023","imageSrc":"/build/journal/compound-component-pattern/image.jpg","imageAlt":"Close-up of a beautiful roman castle with a metallic copper coloured towers rooftops, concrete allure and dark blue interleaved with chatelle tiles.","imageCredit":"Leonardo Diffussion: beautiful roman castle of lego bricks, composition, close-up","imageBlurUri":"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAKAAoDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABQQH/8QAJhAAAQMCBQMFAAAAAAAAAAAAAQIDBAURAAYSITEUUWEiIzJDcf/EABUBAQEAAAAAAAAAAAAAAAAAAAED/8QAGhEAAgMBAQAAAAAAAAAAAAAAAQIAAyEREv/aAAwDAQACEQMRAD8Asp8VNRyjEpVUfYiVKmaylh2SW1dO4lRSvUQrlwgHja19rYz2TlymOSHVxs6UYMKWS2Hl2WE321DvbnzguApTVQjuNqKHFR22ypJsSn2/ST22G3jAMmBDEl20SP8AM/WO/wCYWp8c0ySMLBoGT//Z"},"errors":[],"matter":{"content":"\nStriking an acceptable level of composition is a challenging feat, not only does it take a good time to think about the feature you want to build but it also requires you to reason about and predict the use-cases the component will have to meet in the future.\n\n**Fortunately** for us, there are multiple patterns in React that we can apply to increase the composability of our components. One that I really appreciate is the `Compound Component` pattern and its variations.\n\n## Compound Component\n\nAs a refresher on the `Compound Component` pattern, it lets you split out a component into extendable smaller components that you can compose to build interfaces.\n\n<IllustrationTime summary=\"Example of a real problem from Tom 🧑🏻‍💻, a SWE at WideOpenAI®\">\nTom 🧑🏻‍💻 is the happy maintainer of the `Menu` component:\n\n```javascript\n<Menu items={menuItems} />\n```\n\nJust a simple component that renders a button to toggle a menu and its items. It's a very common component that you'll find in many UI libraries and you probably have a similar component in your codebase (so do I!).\n\nBut one day Tom's boss 🤵🏽‍♀️ calls him:\n\n> 🤵🏽‍♀️ Hey, our clients are having trouble checking if they're logged in. Our top bar menu should reflect that.\n\n> 🧑🏻‍💻 Sure thing, I'll get right to it!\n\nEasy peasy! - says Tom 🧑🏻‍💻 - I'll start by adding two new props to the `Menu` component to highlight the login status:\n\n```javascript add=2\n<Menu\n  buttonLabel={loggedIn ? 'Signed in as Tom - Menu ' : 'Unlogged - Menu'}\n  items={menuItems}\n/>\n```\n\nAnd it all _just_ works, he has a happy day and goes home.\n\nBut then you he gets another call from his boss:\n\n> 🤵🏽‍♀️ Hey, our users are having trouble finding the admin panel. I need you to highlight the admin option in the top bar menu.\n\n> 🧑🏻‍💻 Alright!\n\n> 🤵🏽‍♀️ But it should only be highlighted when the user is an admin!\n\nLet's just add another prop! — Tom 🧑🏻‍💻.\n\n```javascript add=3\n<Menu\n  buttonLabel={loggedIn ? 'Signed in as Tom - Menu ' : 'Unlogged - Menu'}\n  isAdmin={isAdmin}\n  items={menuItems}\n/>\n```\n\nAnd it works again! Tom 🧑🏻‍💻 is happy and his changes are deployed to the website. But then he gets another call:\n\n> 🤵🏽‍♀️ Hey, the website is not working! The menu is not opening anymore!\n\n> 🙆🏻‍♂️ What!? I didn't change anything!\n\nSo he sets to debug the issue and finds out that while he was adding the new button he introduced a regression that broke the menu in a page that he didn't even know existed and that it was using the `Menu` component.\n\nHe fixes it and his boss 🤵🏽‍♀️ thanks him for his hard work.\n\n> 🧑🏻‍💻 Wait! What if my boss calls me up again to change the Menu component? There has has to be a better way of extending the `Menu` component without introducing regressions.\n\nDoes this story feel familiar to you? If so, you're not alone. I've been there too! Let's see how we can improve the `Menu` component to make it more flexible and avoid introducing regressions applying [separation of concerns](https://en.wikipedia.org/wiki/Separation_of_concerns) with the Compound Componet pattern.\n\n</IllustrationTime>\n\nLet's take a look at the `Menu` component that Tom 🧑🏻‍💻 built:\n\n```javascript\n<Menu\n  buttonLabel={loggedIn ? 'Signed in as Tom - Menu' : 'Unlogged - Menu'}\n  isAdmin={isAdmin}\n  items={menuItems}\n/>\n```\n\nIt has a few problems:\n\n1. It also doesn't allow you to customize the menu items rendering logic.\n2. It's now linked to implementation details. We want the `Menu` component to be **generic**, we want to use it for other purposes as well. So when extending it for a new use-case we have to make sure that we don't break the existing ones.\n\nThis is the golden example of how you'd go about using the above component if it were using the `Compound Component` pattern:\n\n```javascript\n<Menu>\n  <MenuButton>\n    {loggedIn ? 'Signed in as Tom - Menu' : 'Unlogged - Menu'}\n  </MenuButton>\n\n  <MenuList>\n    <MenuItem>Item 1</MenuItem>\n    <MenuItem>Item 2</MenuItem>\n    {isAdmin && <MenuItem>Admin</MenuItem>}\n  </MenuList>\n</Menu>\n```\n\nThe `Menu` component is the parent component that holds the state of the menu and passes it down to its children. The `MenuButton` and `MenuItem` consume the state and render accordingly. One obvious benefit of this is that it gives you **control** on _what_ pieces of the `Menu` to render and _where_ to render them.\n\nYou could, for example, skip the button alltogether and make it so firing an action toggles on the `Menu`:\n\n```javascript add=2\n<Menu>\n  <LoginDialogWithMenuToggle />\n\n  <MenuList>\n    <MenuItem>Protected action 1</MenuItem>\n    <MenuItem>Protected action 2</MenuItem>\n    <MenuItem>Protected action 3</MenuItem>\n  </MenuList>\n</Menu>\n```\n\nIt was as simple as changing that single line of code and we were able to extend the `Menu` component to support a new use-case.\n\nBut what is going on under the hood? How does the `LoginDialogWithMenuToggle` component know how to trigger the state?\n\nThe answer is the React.Children API and the `cloneElement` method. Here's how it might work (don't give the code too much thought):\n\n```javascript lines=8,18\nfunction Menu({ children }) {\n  const [isOpen, setIsOpen] = React.useState(false)\n\n  const toggleMenu = () => setIsOpen(!isOpen)\n\n  const childrenWithProps = React.Children.map(children, (child) => {\n    if (React.isValidElement(child)) {\n      return React.cloneElement(child, { isOpen, toggleMenu })\n    }\n\n    return child\n  })\n\n  return <div>{childrenWithProps}</div>\n}\n\nfunction MenuList({ children, isOpen }) {\n  return isOpen ? <div>{children}</div> : null\n}\n```\n\nIn this case, `Menu` is going through all of its **direct** children and cloning them to pass them down the `isOpen` and `toggleMenu` props.\n\nThis sounds great _initially_ but it leads you to write fragile code. To illustrate that, imagine you had to put a wrapper between `Menu` and `MenuList`:\n\n```javascript add=4,10 filename=broken-component.jsx broken=true\n<Menu>\n  <MenuButton>Where is my list? :( </MenuButton>\n\n  <div>\n    <MenuList>\n      <MenuItem>Item 1</MenuItem>\n      <MenuItem>Item 2</MenuItem>\n      <MenuItem>Item 3</MenuItem>\n    </MenuList>\n  </div>\n</Menu>\n```\n\nNow the `Menu` component won't be able to pass down the props to the `MenuList` because it's not a **direct** child anymore. We have the entire functionality of `Menu` broken because it is tight to an implementation detail that it can't enforce.\n\nTo fix this, we need to be _flexible_ about _where_ we put the elements in the tree!\n\n> Note: The `Compound Component` pattern as described here is not encouraged anymore [due to the API it uses are fragile](https://beta.reactjs.org/reference/react/Children) as shown above. Going forward you should only be using the `Flexible Compound Component` pattern we'll see now.\n\n## Flexible Compound Component\n\nThis pattern works by enhancing the `Compound Component` pattern by using the React Context API to pass down the state to its children _anywhere in the tree_. To the developer implementing a Flexible Compound Component, it's <s>exactly like</s> very similar to the component we've seen so far:\n\n```javascript filename=functional-component.jsx\n<Menu>\n  <MenuButton>I toggle the collapsable menu! :)</MenuButton>\n\n  <div>\n    <MenuList>\n      <MenuItem>Item 1</MenuItem>\n      <MenuItem>Item 2</MenuItem>\n      <MenuItem>Item 3</MenuItem>\n    </MenuList>\n  </div>\n</Menu>\n```\n\nBut internally the `Menu` component is now exposing its state via React Context:\n\n```javascript lines=1,7,14,22\nconst MenuContext = React.createContext()\n\nfunction Menu({ children }) {\n  const state = React.useState(false)\n\n  return (\n    <MenuContext.Provider value={state}>\n      <div>{children}</div>\n    </MenuContext.Provider>\n  )\n}\n\nfunction MenuButton({ children }) {\n  const [, setIsOpen] = React.useContext(MenuContext)\n\n  const toggle = () => setIsOpen((isOpen) => !isOpen)\n\n  return <button onClick={toggle}>{children}</button>\n}\n\nfunction MenuList({ children }) {\n  const [isOpen] = React.useContext(MenuContext)\n  return isOpen ? <div>{children}</div> : null\n}\n```\n\nWe can see that now, we're not limited to the direct children of `Menu` to consume the state. We can put the `MenuButton` anywhere in the tree and it will still be able to toggle the `Menu`.\n\n## Conclusion\n\n<Details summary=\"Did you have a déja vú with this pattern?\">\n  This pattern is not only a React thing. Behold the [`option`/`select`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select) DOM elemets:\n\n```javascript\n<select className=\"...\">\n  <option disabled>Option 1</option>\n  <option selected>Option 2</option>\n</select>\n```\n\nOr the magnificient [`details`/`summary`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/details) elements that are used to create collapsables (this very collapsable is using those elements 🤫):\n\n```javascript\n<details>\n  <summary>Click me!</summary>\n  <p>Some hidden content</p>\n</details>\n```\n\nIts amazing that we're able to apply this pattern in React and make it even more flexible with shared state.\n\n</Details>\n\nOverall this API is way more flexible 💪. The `Compound Component` pattern allowed us to compose our Menu component to fit our needs. We can also extend our Menu family of components in a variety of different ways. Got a new use-case? Just add a new component to the family and you're good to go!\n\nWe've just covered how the `Compound Component` pattern gives us the ability to extract and the `Flexible Compound Component` pattern gives us . But there's still plenty of room for improvement. Let's see how we can scale-up this API and optimize it for performance in the next article.\n","data":{"title":"The Compound Component pattern","description":"Exploring the Compound Component pattern and how it helps us build more flexible components","tags":["React","Composition","Api Design"],"date":"04/03/2023","imageSrc":"/build/journal/compound-component-pattern/image.jpg","imageAlt":"Close-up of a beautiful roman castle with a metallic copper coloured towers rooftops, concrete allure and dark blue interleaved with chatelle tiles.","imageCredit":"Leonardo Diffussion: beautiful roman castle of lego bricks, composition, close-up","imageBlurUri":"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAKAAoDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABQQH/8QAJhAAAQMCBQMFAAAAAAAAAAAAAQIDBAURAAYSITEUUWEiIzJDcf/EABUBAQEAAAAAAAAAAAAAAAAAAAED/8QAGhEAAgMBAQAAAAAAAAAAAAAAAQIAAyEREv/aAAwDAQACEQMRAD8Asp8VNRyjEpVUfYiVKmaylh2SW1dO4lRSvUQrlwgHja19rYz2TlymOSHVxs6UYMKWS2Hl2WE321DvbnzguApTVQjuNqKHFR22ypJsSn2/ST22G3jAMmBDEl20SP8AM/WO/wCYWp8c0ySMLBoGT//Z"},"isEmpty":false,"excerpt":""}}